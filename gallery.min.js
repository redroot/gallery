(function(){var b;var a=function(c,d){return function(){return c.apply(d,arguments)}};b=(function(){var c;c={thumbs:true,thumb_width:150,captions:true,meta:true,breakpoints:{tablet:960,mobile:768}};function d(f,e){if(e==null){e={}}this.wrapper=$(f);this.current=this.resolve_current();this.count=this.wrapper.find(".fmg-slide").length;this.loading(true);this.init_bindings();this.resize();this.loading(false)}d.prototype.slide_wrappers=function(){return this.wrapper.find(".fmg-slides-wrapper, .fmg-captions-wrapper")};d.prototype.thumb_wrapper=function(){return this.wrapper.find(".fmg-thumbs-wrapper").first()};d.prototype.init_bindings=function(){$(document).on("click",".fmg-viewport-nav-left",a(function(){this.slide_to(this.current-1);return false},this));$(document).on("click",".fmg-viewport-nav-right",a(function(){this.slide_to(this.current+1);return false},this));$(document).keydown(a(function(f){console.log(f);if(f.keyCode===37){this.slide_to(this.current-1)}if(f.keyCode===39){return this.slide_to(this.current+1)}},this));return window.onresize=a(function(){return this.resize()},this)};d.prototype.slide_to=function(g){var e,f;console.log("sliding to "+g+" of "+this.count);if(g>this.count||g<1){return false}e=-1*this.gallery_width()*(g-1);f=-1*this.calc_thumb_offset(g);this.slide_wrappers().each(function(h,j){return $(j).css("left",""+e+"px")});if(c.thumbs){this.thumb_wrapper().css("left",""+f+"px")}this.current=g;this.set_current_elements();this.set_navigation_hidden();window.location.hash=g===1?"":"#slide-"+g;return console.log(e+" "+f)};d.prototype.resize=function(){var e;e=this.gallery_width();this.wrapper.addClass("is-resizing");if(this.resizing_timeout){clearTimeout(this.resizing_timeout)}this.resizing_timeout=setTimeout(a(function(){return this.wrapper.removeClass("is-resizing")},this),100);if(e<c.breakpoints.mobile){this.wrapper.removeClass("fmg-gallery-tablet").addClass("fmg-gallery-mobile")}else{if(e<c.breakpoints.tablet){this.wrapper.removeClass("fmg-gallery-mobile").addClass("fmg-gallery-tablet")}else{this.wrapper.removeClass("fmg-gallery-tablet fmg-gallery-mobile")}}this.wrapper.find(".fmg-slide, .fmg-caption").each(function(){return $(this).width(e)});this.slide_wrappers().each(a(function(f,g){return $(g).width(e*this.count)},this));if(c.thumbs){this.thumb_wrapper().width(Math.ceil(c.thumb_width*this.count))}return this.slide_to(this.current)};d.prototype.loading=function(e){if(e){this.wrapper.addClass("is-loading")}if(!e){return this.wrapper.removeClass("is-loading")}};d.prototype.gallery_width=function(){return this.wrapper.width()};d.prototype.calc_thumb_offset=function(i){var f,e,g,h;g=Math.ceil((c.thumb_width*this.count)/this.gallery_width());f=1;while(f<=g){h=(this.count/g)*(f-1);e=(this.count/g)*f;if(i>h&&i<=e){break}f++}return this.gallery_width()*(f-1)};d.prototype.set_current_elements=function(){var e;e=this.current-1;this.wrapper.find(".fmg-slide,.fmg-caption,.fmg-thumbs img").removeClass("is-current");return this.wrapper.find(".fmg-slide:eq("+e+"),.fmg-caption:eq("+e+"),.fmg-thumbs img:eq("+e+")").addClass("is-current")};d.prototype.set_navigation_hidden=function(){this.wrapper.find(".fmg-viewport-nav").removeClass("is-hidden");if(this.current===1){this.wrapper.find(".fmg-viewport-nav-left").addClass("is-hidden")}if(this.current===this.count){return this.wrapper.find(".fmg-viewport-nav-right").addClass("is-hidden")}};d.prototype.resolve_current=function(){if(window.location.hash===""||window.location.hash.indexOf("#slide-")===-1){return 1}return parseInt(window.location.hash.split("#slide-",2)[1])||1};d.prototype.add_listener=function(f,e){this.events||(this.events=[]);if(!this.events[f]){this.events[f]=[]}return this.events[f].push(e)};d.prototype.trigger=function(i,h){var e,k,g,j,f;if(this.events[i]){j=this.events[i];f=[];for(k=0,g=j.length;k<g;k++){e=j[k];f.push(e(h))}return f}};return d})();new b("#gallery_one")}).call(this);